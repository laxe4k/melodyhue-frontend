<section class="auth">
  <div class="auth__card">
    <header class="auth__header">
      <h1>{{ title() }}</h1>
      <p class="auth__subtitle">
        {{ subtitle() }}
        <a routerLink="/auth/login" class="auth__link">{{ loginLink() }}</a>
      </p>
    </header>

    <form class="auth__form" [formGroup]="form" (ngSubmit)="onSubmit()" aria-describedby="register-form-description"
      aria-live="polite" novalidate>
      <p id="register-form-description" class="visually-hidden">
        {{ formDescription() }}
      </p>

      <div class="form-field">
        <label for="username">{{ usernameLabel() }}</label>
        <input id="username" type="text" formControlName="username" autocomplete="username" minlength="3" maxlength="30"
          [class.form-field__input--invalid]="canShowUsernameError()" [attr.aria-invalid]="canShowUsernameError()"
          [attr.aria-describedby]="canShowUsernameError() ? 'username-error' : null" />
        @if (canShowUsernameError()) {
        <p id="username-error" class="form-field__error">{{ getUsernameError() }}</p>
        }
      </div>

      <div class="form-field">
        <label for="email">{{ emailLabel() }}</label>
        <input id="email" type="email" formControlName="email" autocomplete="email"
          [class.form-field__input--invalid]="canShowEmailError()" [attr.aria-invalid]="canShowEmailError()"
          [attr.aria-describedby]="canShowEmailError() ? 'email-error' : null" />
        @if (canShowEmailError()) {
        <p id="email-error" class="form-field__error">{{ getEmailError() }}</p>
        }
      </div>

      <div class="form-field">
        <label for="password">{{ passwordLabel() }}</label>
        <input id="password" type="password" formControlName="password" autocomplete="new-password"
          [class.form-field__input--invalid]="canShowPasswordError()" [attr.aria-invalid]="canShowPasswordError()"
          [attr.aria-describedby]="canShowPasswordError() ? 'password-error' : null" />
        @if (canShowPasswordError()) {
        <p id="password-error" class="form-field__error">{{ getPasswordError() }}</p>
        }
      </div>

      <div class="form-field">
        <label for="confirmPassword">{{ confirmPasswordLabel() }}</label>
        <input id="confirmPassword" type="password" formControlName="confirmPassword" autocomplete="new-password"
          [class.form-field__input--invalid]="canShowConfirmPasswordError()"
          [attr.aria-invalid]="canShowConfirmPasswordError()"
          [attr.aria-describedby]="canShowConfirmPasswordError() ? 'confirmPassword-error' : null" />
        @if (canShowConfirmPasswordError()) {
        <p id="confirmPassword-error" class="form-field__error">{{ getConfirmPasswordError() }}</p>
        }
      </div>

      <label class="checkbox">
        <input type="checkbox" formControlName="acceptTerms" />
        <span>
          {{ acceptTermsLabel() }}
          <a routerLink="/legal/terms" class="auth__link">{{ termsLink() }}</a>
          {{ andText() }}
          <a routerLink="/legal/privacy" class="auth__link">{{ privacyLink() }}</a>.
        </span>
      </label>
      @if (shouldShowAcceptTermsError()) {
      <p class="form-field__error">{{ getAcceptTermsError() }}</p>
      }

      <app-button type="submit" [fullWidth]="true" variant="accent" [disabled]="submissionInProgress()"
        [attr.aria-busy]="submissionInProgress()">
        @if (submissionInProgress()) {
        <span>{{ submittingLabel() }}</span>
        } @else {
        <span>{{ submitButtonLabel() }}</span>
        }
      </app-button>

      @if (formError()) {
      <div class="form-alert form-alert--after-submit" role="alert">
        <i class="fa-solid fa-triangle-exclamation" aria-hidden="true"></i>
        <span>{{ formError() }}</span>
      </div>
      }
    </form>
  </div>
</section>