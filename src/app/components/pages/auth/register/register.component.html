<section class="auth">
    <div class="auth__card">
        <header class="auth__header">
            <h1>Création de compte</h1>
            <p class="auth__subtitle">
                Déjà inscrit ?
                <a routerLink="/auth/login" class="auth__link">Se connecter</a>
            </p>
        </header>

        <form class="auth__form" [formGroup]="form" (ngSubmit)="onSubmit()" aria-describedby="register-form-description"
            aria-live="polite" novalidate>
            <p id="register-form-description" class="visually-hidden">
                Tous les champs sont obligatoires et doivent être valides pour créer votre compte.
            </p>

            <div class="form-field">
                <label for="username">Pseudo</label>
                <input id="username" type="text" formControlName="username" autocomplete="username" minlength="3"
                    maxlength="30" [class.form-field__input--invalid]="canShowUsernameError()"
                    [attr.aria-invalid]="canShowUsernameError()"
                    [attr.aria-describedby]="canShowUsernameError() ? 'username-error' : null" />
                @if (canShowUsernameError()) {
                <p id="username-error" class="form-field__error">{{ getUsernameError() }}</p>
                }
            </div>

            <div class="form-field">
                <label for="email">Adresse e-mail</label>
                <input id="email" type="email" formControlName="email" autocomplete="email"
                    [class.form-field__input--invalid]="canShowEmailError()" [attr.aria-invalid]="canShowEmailError()"
                    [attr.aria-describedby]="canShowEmailError() ? 'email-error' : null" />
                @if (canShowEmailError()) {
                <p id="email-error" class="form-field__error">{{ getEmailError() }}</p>
                }
            </div>

            <div class="form-field">
                <label for="password">Mot de passe</label>
                <input id="password" type="password" formControlName="password" autocomplete="new-password"
                    [class.form-field__input--invalid]="canShowPasswordError()"
                    [attr.aria-invalid]="canShowPasswordError()"
                    [attr.aria-describedby]="canShowPasswordError() ? 'password-error' : null" />
                @if (canShowPasswordError()) {
                <p id="password-error" class="form-field__error">{{ getPasswordError() }}</p>
                }
            </div>

            <div class="form-field">
                <label for="confirmPassword">Confirmation du mot de passe</label>
                <input id="confirmPassword" type="password" formControlName="confirmPassword"
                    autocomplete="new-password" [class.form-field__input--invalid]="canShowConfirmPasswordError()"
                    [attr.aria-invalid]="canShowConfirmPasswordError()"
                    [attr.aria-describedby]="canShowConfirmPasswordError() ? 'confirmPassword-error' : null" />
                @if (canShowConfirmPasswordError()) {
                <p id="confirmPassword-error" class="form-field__error">{{ getConfirmPasswordError() }}</p>
                }
            </div>

            <label class="checkbox">
                <input type="checkbox" formControlName="acceptTerms" />
                <span>
                    J'accepte les
                    <a routerLink="/legal/terms" class="auth__link">conditions d'utilisation</a>
                    et la
                    <a routerLink="/legal/privacy" class="auth__link">politique de confidentialité</a>.
                </span>
            </label>
            @if (shouldShowAcceptTermsError()) {
            <p class="form-field__error">Vous devez accepter les conditions pour continuer</p>
            }

            <button type="submit" class="auth__submit" [disabled]="submissionInProgress()"
                [attr.aria-busy]="submissionInProgress()">
                @if (submissionInProgress()) {
                <span>Création en cours…</span>
                } @else {
                <span>Créer mon compte</span>
                }
            </button>
        </form>
    </div>
</section>