* {
  box-sizing: border-box;
}
:host {
  display: block;
  height: 100vh;
  width: 100vw;
  background: transparent;
  overflow: hidden;
}

.compact {
  height: 100vh;
  width: 100vw;
  display: grid;
  place-items: center;
}

.card {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: center;
  gap: var(--gap);
  --cover-w: 64px;
  --panel-w: 300px;
  --gap: 10px;
  --epsilon: 4px;
  position: relative;
  overflow: hidden;
}
.cover {
  width: var(--cover-w);
  height: var(--cover-w);
  object-fit: cover;
  border-radius: 10px;
  position: relative;
  z-index: 2;
}
.panel {
  width: var(--panel-w);
  padding: 8px 12px;
  border-radius: 12px;
  background: rgba(0, 0, 0, 0.9);
  height: var(--cover-w);
  display: flex;
  align-items: center;
  overflow: hidden;
  position: relative;
  z-index: 1;
  will-change: transform, width;
  backface-visibility: hidden;
  transition: transform 0.65s cubic-bezier(0.16, 1, 0.3, 1),
    width 0.65s cubic-bezier(0.16, 1, 0.3, 1);
  transform: translateX(0);
}
.texts {
  min-width: 0;
  display: grid;
  gap: 4px;
}
.line {
  min-width: 0;
  overflow: hidden;
  white-space: nowrap;
}
.line.title {
  color: #fff;
  font-weight: 700;
  font-size: 18px;
  line-height: 1.15;
}
.line.artist {
  color: rgba(255, 255, 255, 0.86);
  font-weight: 500;
  font-size: 13px;
}

.marquee {
  position: relative;
  overflow: hidden;
}
.marquee__inner {
  display: inline-flex;
  white-space: nowrap;
  will-change: transform;
  animation: cpt-marquee 16s linear infinite;
  animation-play-state: paused;
}
.run-marquee .marquee__inner {
  animation-play-state: running;
}
.text {
  display: inline-block;
  white-space: nowrap;
  padding-right: 40px;
}
.text.clone {
  display: none;
}
.no-scroll .marquee__inner {
  animation: none;
  transform: translateX(0);
}
.no-scroll .clone {
  display: none;
}
.run-marquee .marquee:not(.no-scroll) .clone {
  display: inline-block;
}

@keyframes cpt-marquee {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-50%);
  }
}

@media (max-width: 720px) {
  .card {
    --cover-w: 56px;
    --panel-w: 240px;
  }
  .panel {
    min-width: 220px;
  }
  .line.title {
    font-size: 16px;
  }
  .line.artist {
    font-size: 12px;
  }
}

/* Pause: rentrer le panel sous l'image puis fade out de la carte après 1.6s */
.compact:not(.show) .panel {
  /* glisse entièrement sous la cover pour éviter tout dépassement à droite */
  transform: translateX(calc(-100% - var(--gap) - var(--epsilon)));
  /* réduit la largeur à 0 pour disparaître complètement sous l'image sans déformation */
  width: 0;
}
.compact:not(.show) .card {
  opacity: 0;
  transition: opacity 0.35s ease;
  transition-delay: 1.6s;
}
.compact.show .card {
  opacity: 1;
  transition: opacity 0.2s ease;
  transition-delay: 0s;
}
